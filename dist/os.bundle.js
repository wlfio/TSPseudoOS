!function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=13)}([function(t,e){var r={utf8:{stringToBytes:function(t){return r.bin.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(r.bin.bytesToString(t)))}},bin:{stringToBytes:function(t){for(var e=[],r=0;r<t.length;r++)e.push(255&t.charCodeAt(r));return e},bytesToString:function(t){for(var e=[],r=0;r<t.length;r++)e.push(String.fromCharCode(t[r]));return e.join("")}}};t.exports=r},,,function(t,e,r){(function(e){var n,i,o,s;n=r(10),i=r(0).utf8,o=r(0).bin,(s=function(t,r){var s=n.wordsToBytes(function(t){t.constructor==String?t=i.stringToBytes(t):void 0!==e&&"function"==typeof e.isBuffer&&e.isBuffer(t)?t=Array.prototype.slice.call(t,0):Array.isArray(t)||(t=t.toString());var r=n.bytesToWords(t),o=8*t.length,s=[],a=1732584193,u=-271733879,h=-1732584194,c=271733878,l=-1009589776;r[o>>5]|=128<<24-o%32,r[15+(o+64>>>9<<4)]=o;for(var f=0;f<r.length;f+=16){for(var p=a,d=u,g=h,y=c,m=l,w=0;w<80;w++){if(w<16)s[w]=r[f+w];else{var v=s[w-3]^s[w-8]^s[w-14]^s[w-16];s[w]=v<<1|v>>>31}var S=(a<<5|a>>>27)+l+(s[w]>>>0)+(w<20?1518500249+(u&h|~u&c):w<40?1859775393+(u^h^c):w<60?(u&h|u&c|h&c)-1894007588:(u^h^c)-899497514);l=c,c=h,h=u<<30|u>>>2,u=a,a=S}a+=p,u+=d,h+=g,c+=y,l+=m}return[a,u,h,c,l]}(t));return r&&r.asBytes?s:r&&r.asString?o.bytesToString(s):n.bytesToHex(s)})._blocksize=16,s._digestsize=20,t.exports=s}).call(this,r(5).Buffer)},,function(t,e,r){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var n=r(7),i=r(8),o=r(9);function s(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(null===t&&(t=new u(e)),t.length=e),t}function u(t,e,r){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,e,r);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return l(this,t)}return h(this,t,e,r)}function h(t,e,r,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,r,n){if(e.byteLength,r<0||e.byteLength<r)throw new RangeError("'offset' is out of bounds");if(e.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");e=void 0===r&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,r):new Uint8Array(e,r,n);u.TYPED_ARRAY_SUPPORT?(t=e).__proto__=u.prototype:t=f(t,e);return t}(t,e,r,n):"string"==typeof e?function(t,e,r){"string"==typeof r&&""!==r||(r="utf8");if(!u.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|d(e,r),i=(t=a(t,n)).write(e,r);i!==n&&(t=t.slice(0,i));return t}(t,e,r):function(t,e){if(u.isBuffer(e)){var r=0|p(e.length);return 0===(t=a(t,r)).length?t:(e.copy(t,0,0,r),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(n=e.length)!=n?a(t,0):f(t,e);if("Buffer"===e.type&&o(e.data))return f(t,e.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function l(t,e){if(c(e),t=a(t,e<0?0:0|p(e)),!u.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)t[r]=0;return t}function f(t,e){var r=e.length<0?0:0|p(e.length);t=a(t,r);for(var n=0;n<r;n+=1)t[n]=255&e[n];return t}function p(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function d(t,e){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return N(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return z(t).length;default:if(n)return N(t).length;e=(""+e).toLowerCase(),n=!0}}function g(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return _(this,e,r);case"utf8":case"utf-8":return O(this,e,r);case"ascii":return T(this,e,r);case"latin1":case"binary":return I(this,e,r);case"base64":return A(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function y(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function m(t,e,r,n,i){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof e&&(e=u.from(e,n)),u.isBuffer(e))return 0===e.length?-1:w(t,e,r,n,i);if("number"==typeof e)return e&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):w(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function w(t,e,r,n,i){var o,s=1,a=t.length,u=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,r/=2}function h(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var c=-1;for(o=r;o<a;o++)if(h(t,o)===h(e,-1===c?0:o-c)){if(-1===c&&(c=o),o-c+1===u)return c*s}else-1!==c&&(o-=o-c),c=-1}else for(r+u>a&&(r=a-u),o=r;o>=0;o--){for(var l=!0,f=0;f<u;f++)if(h(t,o+f)!==h(e,f)){l=!1;break}if(l)return o}return-1}function v(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))return s;t[r+s]=a}return s}function S(t,e,r,n){return q(N(e,t.length-r),t,r,n)}function b(t,e,r,n){return q(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function E(t,e,r,n){return b(t,e,r,n)}function P(t,e,r,n){return q(z(e),t,r,n)}function R(t,e,r,n){return q(function(t,e){for(var r,n,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)r=t.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(e,t.length-r),t,r,n)}function A(t,e,r){return 0===e&&r===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,r))}function O(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;i<r;){var o,s,a,u,h=t[i],c=null,l=h>239?4:h>223?3:h>191?2:1;if(i+l<=r)switch(l){case 1:h<128&&(c=h);break;case 2:128==(192&(o=t[i+1]))&&(u=(31&h)<<6|63&o)>127&&(c=u);break;case 3:o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&(u=(15&h)<<12|(63&o)<<6|63&s)>2047&&(u<55296||u>57343)&&(c=u);break;case 4:o=t[i+1],s=t[i+2],a=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(u=(15&h)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(c=u)}null===c?(c=65533,l=1):c>65535&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|1023&c),n.push(c),i+=l}return function(t){var e=t.length;if(e<=C)return String.fromCharCode.apply(String,t);var r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=C));return r}(n)}e.Buffer=u,e.SlowBuffer=function(t){+t!=t&&(t=0);return u.alloc(+t)},e.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=s(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,r){return h(null,t,e,r)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,e,r){return function(t,e,r,n){return c(e),e<=0?a(t,e):void 0!==r?"string"==typeof n?a(t,e).fill(r,n):a(t,e).fill(r):a(t,e)}(null,t,e,r)},u.allocUnsafe=function(t){return l(null,t)},u.allocUnsafeSlow=function(t){return l(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,e){if(!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,n=e.length,i=0,o=Math.min(r,n);i<o;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=u.allocUnsafe(e),i=0;for(r=0;r<t.length;++r){var s=t[r];if(!u.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,i),i+=s.length}return n},u.byteLength=d,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)y(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)y(this,e,e+3),y(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)y(this,e,e+7),y(this,e+1,e+6),y(this,e+2,e+5),y(this,e+3,e+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?O(this,0,t):g.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,e,r,n,i){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&e>=r)return 0;if(n>=i)return-1;if(e>=r)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(e>>>=0),a=Math.min(o,s),h=this.slice(n,i),c=t.slice(e,r),l=0;l<a;++l)if(h[l]!==c[l]){o=h[l],s=c[l];break}return o<s?-1:s<o?1:0},u.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},u.prototype.indexOf=function(t,e,r){return m(this,t,e,r,!0)},u.prototype.lastIndexOf=function(t,e,r){return m(this,t,e,r,!1)},u.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return v(this,t,e,r);case"utf8":case"utf-8":return S(this,t,e,r);case"ascii":return b(this,t,e,r);case"latin1":case"binary":return E(this,t,e,r);case"base64":return P(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,t,e,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var C=4096;function T(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function I(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function _(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=e;o<r;++o)i+=F(t[o]);return i}function B(t,e,r){for(var n=t.slice(e,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function x(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function U(t,e,r,n,i,o){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function D(t,e,r,n){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-r,2);i<o;++i)t[r+i]=(e&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function M(t,e,r,n){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-r,4);i<o;++i)t[r+i]=e>>>8*(n?i:3-i)&255}function L(t,e,r,n,i,o){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function k(t,e,r,n,o){return o||L(t,0,r,4),i.write(t,e,r,n,23,4),r+4}function j(t,e,r,n,o){return o||L(t,0,r,8),i.write(t,e,r,n,52,8),r+8}u.prototype.slice=function(t,e){var r,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t),u.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,e)).__proto__=u.prototype;else{var i=e-t;r=new u(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+t]}return r},u.prototype.readUIntLE=function(t,e,r){t|=0,e|=0,r||x(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n},u.prototype.readUIntBE=function(t,e,r){t|=0,e|=0,r||x(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},u.prototype.readUInt8=function(t,e){return e||x(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return e||x(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||x(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return e||x(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||x(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,r){t|=0,e|=0,r||x(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*e)),n},u.prototype.readIntBE=function(t,e,r){t|=0,e|=0,r||x(t,e,this.length);for(var n=e,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},u.prototype.readInt8=function(t,e){return e||x(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){e||x(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt16BE=function(t,e){e||x(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt32LE=function(t,e){return e||x(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||x(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||x(t,4,this.length),i.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return e||x(t,4,this.length),i.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||x(t,8,this.length),i.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return e||x(t,8,this.length),i.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,r,n){(t=+t,e|=0,r|=0,n)||U(this,t,e,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[e]=255&t;++o<r&&(i*=256);)this[e+o]=t/i&255;return e+r},u.prototype.writeUIntBE=function(t,e,r,n){(t=+t,e|=0,r|=0,n)||U(this,t,e,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+r},u.prototype.writeUInt8=function(t,e,r){return t=+t,e|=0,r||U(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,r){return t=+t,e|=0,r||U(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):D(this,t,e,!0),e+2},u.prototype.writeUInt16BE=function(t,e,r){return t=+t,e|=0,r||U(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):D(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,r){return t=+t,e|=0,r||U(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):M(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,r){return t=+t,e|=0,r||U(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):M(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e|=0,!n){var i=Math.pow(2,8*r-1);U(this,t,e,r,i-1,-i)}var o=0,s=1,a=0;for(this[e]=255&t;++o<r&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+r},u.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e|=0,!n){var i=Math.pow(2,8*r-1);U(this,t,e,r,i-1,-i)}var o=r-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+r},u.prototype.writeInt8=function(t,e,r){return t=+t,e|=0,r||U(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,r){return t=+t,e|=0,r||U(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):D(this,t,e,!0),e+2},u.prototype.writeInt16BE=function(t,e,r){return t=+t,e|=0,r||U(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):D(this,t,e,!1),e+2},u.prototype.writeInt32LE=function(t,e,r){return t=+t,e|=0,r||U(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):M(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,r){return t=+t,e|=0,r||U(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):M(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,r){return k(this,t,e,!0,r)},u.prototype.writeFloatBE=function(t,e,r){return k(this,t,e,!1,r)},u.prototype.writeDoubleLE=function(t,e,r){return j(this,t,e,!0,r)},u.prototype.writeDoubleBE=function(t,e,r){return j(this,t,e,!1,r)},u.prototype.copy=function(t,e,r,n){if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var i,o=n-r;if(this===t&&r<e&&e<n)for(i=o-1;i>=0;--i)t[i+e]=this[i+r];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+o),e);return o},u.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!u.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var o;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(o=e;o<r;++o)this[o]=t;else{var s=u.isBuffer(t)?t:N(new u(t,n).toString()),a=s.length;for(o=0;o<r-e;++o)this[o+e]=s[o%a]}return this};var Y=/[^+\/0-9A-Za-z-_]/g;function F(t){return t<16?"0"+t.toString(16):t.toString(16)}function N(t,e){var r;e=e||1/0;for(var n=t.length,i=null,o=[],s=0;s<n;++s){if((r=t.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function z(t){return n.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(Y,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function q(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}}).call(this,r(6))},function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){"use strict";e.byteLength=function(t){var e=h(t),r=e[0],n=e[1];return 3*(r+n)/4-n},e.toByteArray=function(t){var e,r,n=h(t),s=n[0],a=n[1],u=new o(function(t,e,r){return 3*(e+r)/4-r}(0,s,a)),c=0,l=a>0?s-4:s;for(r=0;r<l;r+=4)e=i[t.charCodeAt(r)]<<18|i[t.charCodeAt(r+1)]<<12|i[t.charCodeAt(r+2)]<<6|i[t.charCodeAt(r+3)],u[c++]=e>>16&255,u[c++]=e>>8&255,u[c++]=255&e;2===a&&(e=i[t.charCodeAt(r)]<<2|i[t.charCodeAt(r+1)]>>4,u[c++]=255&e);1===a&&(e=i[t.charCodeAt(r)]<<10|i[t.charCodeAt(r+1)]<<4|i[t.charCodeAt(r+2)]>>2,u[c++]=e>>8&255,u[c++]=255&e);return u},e.fromByteArray=function(t){for(var e,r=t.length,i=r%3,o=[],s=0,a=r-i;s<a;s+=16383)o.push(c(t,s,s+16383>a?a:s+16383));1===i?(e=t[r-1],o.push(n[e>>2]+n[e<<4&63]+"==")):2===i&&(e=(t[r-2]<<8)+t[r-1],o.push(n[e>>10]+n[e>>4&63]+n[e<<2&63]+"="));return o.join("")};for(var n=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,u=s.length;a<u;++a)n[a]=s[a],i[s.charCodeAt(a)]=a;function h(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function c(t,e,r){for(var i,o,s=[],a=e;a<r;a+=3)i=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),s.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,r,n,i){var o,s,a=8*i-n-1,u=(1<<a)-1,h=u>>1,c=-7,l=r?i-1:0,f=r?-1:1,p=t[e+l];for(l+=f,o=p&(1<<-c)-1,p>>=-c,c+=a;c>0;o=256*o+t[e+l],l+=f,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=n;c>0;s=256*s+t[e+l],l+=f,c-=8);if(0===o)o=1-h;else{if(o===u)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,n),o-=h}return(p?-1:1)*s*Math.pow(2,o-n)},e.write=function(t,e,r,n,i,o){var s,a,u,h=8*o-i-1,c=(1<<h)-1,l=c>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,d=n?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+l>=1?f/u:f*Math.pow(2,1-l))*u>=2&&(s++,u/=2),s+l>=c?(a=0,s=c):s+l>=1?(a=(e*u-1)*Math.pow(2,i),s+=l):(a=e*Math.pow(2,l-1)*Math.pow(2,i),s=0));i>=8;t[r+p]=255&a,p+=d,a/=256,i-=8);for(s=s<<i|a,h+=i;h>0;t[r+p]=255&s,p+=d,s/=256,h-=8);t[r+p-d]|=128*g}},function(t,e){var r={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)}},function(t,e){var r,n;r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n={rotl:function(t,e){return t<<e|t>>>32-e},rotr:function(t,e){return t<<32-e|t>>>e},endian:function(t){if(t.constructor==Number)return 16711935&n.rotl(t,8)|4278255360&n.rotl(t,24);for(var e=0;e<t.length;e++)t[e]=n.endian(t[e]);return t},randomBytes:function(t){for(var e=[];t>0;t--)e.push(Math.floor(256*Math.random()));return e},bytesToWords:function(t){for(var e=[],r=0,n=0;r<t.length;r++,n+=8)e[n>>>5]|=t[r]<<24-n%32;return e},wordsToBytes:function(t){for(var e=[],r=0;r<32*t.length;r+=8)e.push(t[r>>>5]>>>24-r%32&255);return e},bytesToHex:function(t){for(var e=[],r=0;r<t.length;r++)e.push((t[r]>>>4).toString(16)),e.push((15&t[r]).toString(16));return e.join("")},hexToBytes:function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(parseInt(t.substr(r,2),16));return e},bytesToBase64:function(t){for(var e=[],n=0;n<t.length;n+=3)for(var i=t[n]<<16|t[n+1]<<8|t[n+2],o=0;o<4;o++)8*n+6*o<=8*t.length?e.push(r.charAt(i>>>6*(3-o)&63)):e.push("=");return e.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/gi,"");for(var e=[],n=0,i=0;n<t.length;i=++n%4)0!=i&&e.push((r.indexOf(t.charAt(n-1))&Math.pow(2,-2*i+8)-1)<<2*i|r.indexOf(t.charAt(n))>>>6-2*i);return e}},t.exports=n},,,function(t,e,r){"use strict";r.r(e);const n=t=>"/"+t.split("/").reduce((t,e)=>e.length>0&&"."!==e?".."===e?t.slice(0,t.length-1):[...t,e]:t,[]).join("/"),i=t=>0!==t.indexOf("FSF:")?"FSF:"+n(t):t,o=t=>0!==t.indexOf("FSD:")?"FSD:"+n(t):t,s=t=>0!==t.indexOf("FSP:")?"FSP:"+n(t):t,a=t=>0!==t.indexOf("FSO:")?"FSO:"+n(t):t,u=t=>(t=>localStorage.getItem(a(t))||"nobody:nobody")(t).split(":"),h=t=>u(t)[0],c=t=>parseInt(localStorage.getItem(s(t))||"",16),l=t=>{let e="";return e+=4&t?"r":"-",e+=2&t?"w":"-",e+=1&t?"x":"-"},f=t=>l(t>>8)+l(t>>4)+l(t>>0),p=t=>c(t)>>8,d=t=>c(t)>>4,g=t=>c(t)>>0,y=(t,e,r)=>{return!!(r.groups.includes((t=>u(t)[1])(t))&&d(t)&e)},m=(t,e,r)=>((t,e,r)=>{const n=r.user;return r.priveledged?!(1&e)||(1&p(t)||1&d(t)||1&g(t)):!!(n===h(t)&&p(t)&e)})(t,e,r)||y(t,e,r)||((t,e)=>!!(g(t)&e))(t,e),w=t=>t.split("/").pop()||"",v=t=>{const e=w(t).split(".");return e.length>1&&e.pop()||""},S=t=>t.length<1||"/"===t||"___dir___"===localStorage.getItem(o(t)),b=t=>{if(!S(t))throw new Error(["Access Error","Path is not directory",t].join(" : "))},E=t=>{const e=t.split("/");return t=e.slice(0,e.length-1).join("/")},P=(t,e,r)=>{if(!m(t,e,r))throw new Error(["Permissions Error","Denied "+l(e),t].join(" : "))},R=(t,e,r)=>P(E(t),e,r),A=t=>{if(!S(t))throw new Error(["Access Error","Cannot access '"+t+"': No such file or directory",t].join(" : "))},O=t=>null!==localStorage.getItem(i(t)),C=t=>{if(!O(t))throw new Error(["Access Error","Cannot access '"+t+"': No such file or directory",t].join(" : "))},T=(t,e)=>(e=(t=>("/"!==t.charAt(0)&&(t="/"+t),"/"!==t.charAt(t.length-1)&&(t+="/"),t))(e||"/"),"/"!==(t=t.trim()).charAt(0)&&(t=e+t),t=n(t)),I=(t,e,r)=>(r=!1!==r,"~"===(t=t.trim()).charAt(0)&&(t=t.replace("~","/home/"+e.user+"/")),t=T(t,e.workingDir),r&&((t,e)=>{const r=(t=E(t)).split("/");for(let t=2;t<=r.length;t++){const n=r.slice(0,t).join("/");b(n),P(n,1,e)}})(t,e),t),_=(t,e,r,n)=>{let i=0;i|=e<<8,i|=r<<4,i|=n<<0,localStorage.setItem(s(t),"0x"+i.toString(16))},B=(t,e,r,n)=>{localStorage.setItem(a(t),[r||e.user,n||e.user].join(":"))},x=(t,e,r)=>{const n=r.getIdentity();try{t=I(t,n);const r=O(t);return r?P(t,2,n):R(t,2,n),Promise.resolve(((t,e,r,n)=>(r=!0===r,localStorage.setItem(i(t),e),r||(_(t,6,4,4),B(t,n)),[t,e]))(t,e,r,n))}catch(t){return Promise.reject(t)}},U=t=>localStorage.getItem(i(t)),D=(t,e)=>{const r=e.getIdentity();try{return t=I(t,r),C(t),P(t,4,r),Promise.resolve(U(t))}catch(t){return Promise.reject(t)}},M=(t,e)=>{const r=e.getIdentity();try{const e=((t,e)=>[I(t,e),...e.path.map(e=>T(t,e))])(t=(t=>t.replace(/\//g,""))(t),r);for(let t=0;t<e.length;t++){const n=e[t];if(O(n)&&m(n,1,r))return Promise.resolve(n)}throw new Error(["FS Error",t,"Not found"].join(" : "))}catch(t){return Promise.reject(t)}};var L={read:D,write:x,del:(t,e)=>{const r=e.getIdentity();try{return t=I(t,r),R(t,2,r),C(t),Promise.resolve((t=>(localStorage.removeItem(i(t)),localStorage.removeItem(s(t)),localStorage.removeItem(a(t)),t))(t))}catch(t){return Promise.reject(t)}},list:(t,e)=>{const r=e.getIdentity();try{t=I(t,r),A(t),P(t,4,r);const e=(t=>{const e=i(t)+"/",r=o(t)+"/",n=t.split("/").length;return Object.keys(localStorage).filter(t=>t.startsWith(e)||t.startsWith(r)).filter(t=>t.split("/").length<=n+1).map(t=>{const e=t.split(":");return{file:"FSF"===e[0],path:e[1]}})})(t).map(t=>(t=>{const e=!t.file,r=t.path,n=u(r),i=c(r);return{full:r,path:E(r),name:w(r),ext:e?"":v(r),file:!e,user:n[0],group:n[1],permBytes:i,perms:(e?"d":"-")+f(i),size:e?0:new Blob([U(r)]).size}})(t)).sort((t,e)=>t.full<e.full?-1:t.full>e.full?1:0);return Promise.resolve(e)}catch(t){return Promise.reject(t)}},touch:(t,e)=>x(t,"",e),mkdir:(t,e)=>{const r=e.getIdentity();try{return t=I(t,r),S(t)?Promise.resolve(!1):((t=>{t=E(t),b(t)})(t),(t=>{if(O(t))throw new Error(["Access Error","Path exists",t].join(" : "))})(t),R(t,2,r),Promise.resolve(((t,e)=>!S(t)&&(localStorage.setItem(o(t),"___dir___"),_(t,7,5,5),B(t,e),!0))(t,r)))}catch(t){return Promise.reject(t)}},getExec:M,execRead:(t,e)=>{const r=e.getIdentity();return new Promise((e,n)=>{M(t,r).then(t=>{D(t,r).then(r=>e([t,r])).catch(t=>n(t))}).catch(t=>n(t))})},chmod:(t,e,r)=>{try{const n=e.getIdentity();if(t=I(t,n),C(t),"string"!=typeof r||3!==r.length)throw new Error(["FS Error",""+r,"must be 3 digits long"].join(" : "));const i=parseInt("0x"+r.charAt(1),16),o=parseInt("0x"+r.charAt(0),16),s=parseInt("0x"+r.charAt(2),16);if(n.priveledged||h(t)===n.user)return Promise.resolve(_(t,o,i,s));throw new Error(["FS ERROR",t,"Permissions can only be changed by root or owner"].join(" : "))}catch(t){return Promise.reject(t)}},chown:(t,e,r,n)=>{const i=e.getIdentity();try{if(t=I(t,i),A(t),i.priveledged)return Promise.resolve(B(t,i,r,n));throw new Error(["FS Error","chown","requires root"].join(" : "))}catch(t){Promise.reject(t)}},resolveWorkingPaths:(t,e)=>Promise.resolve(t.map(t=>I(t,e.getIdentity(),!1))),append:(t,e,r)=>new Promise((n,i)=>{D(t,r).then(o=>{o=o||"",x(t,o+=e,r).then(t=>{n(t)}).catch(t=>{i(t)})}).catch(()=>{x(t,e,r).then(t=>{n(t)}).catch(t=>{i(t)})})})};class k{constructor(t,e,r){e=e||[],r=r||"/",this.user=t.toLowerCase(),this.groups=[...e,this.user].filter((t,e,r)=>r.indexOf(t)===e).map(t=>t.toLowerCase()),this.workingDir=r,this.priveledged="root"===this.user,this.path=["/bin"]}getIdentity(){return this.clone()}setPriveledged(t){this.priveledged=t}addToPath(t){this.path=[...this.path,t].filter((t,e,r)=>r.indexOf(t)===e)}clone(){const t=new k(this.user+"",[...this.groups],this.workingDir+"");return t.setPriveledged(!0===this.priveledged),this.path.forEach(e=>t.addToPath(e+"")),t}}var j=r(3),Y=r.n(j);const F=(t,e)=>{const r=new Blob([t],{type:e});return URL.createObjectURL(r)},N={},z=(t,e,r)=>{if(!1===r)return F(t,e);const n=Y()(t);return N.hasOwnProperty(e)||(N[e]={}),N[e].hasOwnProperty(n)||(N[e][n]=F(t,e)),N[e][n]},q=(t,e)=>z(t,"text/javascript",e),J=t=>{t instanceof Array||(t=[t]);let e='<html><head><meta charset = "UTF-8">';return t.forEach(t=>e+=['<script src="',t,'"></scr',"ipt>"].join("")),z(e+="</head><body></body></html>","text/html",!1)},W=(t,e)=>{if(t instanceof k||e.hasOwnProperty("identity")&&(t=e.identity),t instanceof k)return t.clone();throw["Process Start Failed","Missing Identity","None passed or on parent"]};class H{constructor(t,e,r,n,i){if(this.paramsUrl="",this.htmlUrl="",this.children=[],this.parentInCB=null,this.parentEndCB=null,this.id=t,this.exec=e,this.params=r,this.identity=W(n,i),this.container=null,this.bin=[],this.dead=!1,i instanceof H){const t=i.registerChild(this);this.parentInCB=t[0],this.parentEndCB=t[1]}}registerChild(t){return this.children[t.id]=t,[e=>{this.stdIn(t.id,e)},()=>{this.removeChild(t)}]}getIdentity(){return this.identity instanceof k?this.identity.getIdentity():this.identity}hasParent(){return null!==this.parentInCB}intoParent(t){null!==this.parentInCB&&this.parentInCB(t)}getChild(t){return this.children[t]||null}identifier(){return this.exec+"["+this.id+"]"}intoChild(t,e,r){const n=this.getChild(t);null!==n&&(console.log(this.identifier()," > ",n.identifier(),e,r),n.stdIn(r||this.id,e))}set(t,e){switch(t){case"workingDir":this.identity.workingDir=e}}loadLibJS(t){return null===H.libJS&&(H.libJS=q(t)),this.bin.push(H.libJS||""),this}loadBin(t){return this.bin.push(q(t)),this}spawn(t){this.paramsUrl=q(["window.PROCESS = "+JSON.stringify(this)+";"].join("")),this.htmlUrl=J([this.paramsUrl,...this.bin]),t.src=this.htmlUrl,this.container=t}isSource(t){return null!==this.container&&t===this.container.contentWindow}stdIn(t,e){this.message(["Std","in"],{from:t,data:e})}data(){return{id:this.id,exec:this.exec,params:[...this.params],identity:this.identity,dead:this.dead}}message(t,e,r,n){if(null!==this.container){const i=this.container.contentWindow;if(null===i)return!1;const o={type:{service:t[0],func:t[1]},data:e,id:r};return n instanceof Error&&(console.log("Error to process",this,n),n=["ERROR",...n.message.split(" : ")]),void 0!==n&&(o.error=n),i.postMessage(o,location.origin),!0}return!1}respond(t,e,r){this.message(["response"],t,e,r)}removeChild(t){this.message(["Process","end"],t.id),delete this.children[t.id]}kill(){if(this.dead=!0,null===this.container)return;const t=this.container.parentNode;null!==t&&(t.removeChild(this.container),null!==this.parentEndCB&&this.parentEndCB(),this.bin=[],this.htmlUrl.length>0&&URL.revokeObjectURL(this.htmlUrl),this.paramsUrl.length>0&&URL.revokeObjectURL(this.paramsUrl),this.htmlUrl="",this.paramsUrl="")}}H.libJS=null;const K=async()=>{const t=new Request("osLib.bundle.js");return await fetch(t).then(t=>t.text())};const G={ls:()=>{const t={all:!1,human:!1,long:!1,"no-group":!1};let e,r=0;const n={a:"all",h:"human",l:"long",G:"no-group"},i=t=>{let e=CMD.Colours.white,r=CMD.Colours.black;return t.file||(e=CMD.Colours.blue),CMD.Colourize(t.name,e,r)},o=(e,r)=>{let n=[e,["perms\t","user",t["no-group"]?"":"group","size","name"].filter(t=>t.length>0)];return r.map(e=>(e=>{const r={perms:e.perms,user:e.user,group:e.group,size:e.size,name:i(e)};return t["no-group"]&&delete r.group,Object.values(r)})(e)).map(t=>n.push(t)),n},s=(n,s)=>{let a;t.all||(s=s.filter(t=>!t.name.startsWith("."))),a=t.long?o(n,s):(t=>t.map(t=>i(t)))(s),OS.Std.out(a),++r>=e&&OS.Process.end()},a=t=>{OS.Process.crash(t)};(r=>{OS.Util.loadArgs(r,t,n).then(t=>{e=t.length,t.length<1&&(t=[""],e=1),t.map(t=>(t=>{OS.FS.list(t).then(e=>s(t,e)).catch(t=>a(t))})(t))}).catch(t=>a(t))})(PROCESS.params)},bash:()=>{let t,e="",r="",n=window.location.origin.split("://")[1].split(":")[0]||"[MISSING HOST]",i=-1,o=!1;const s={};let a=[],u=0;const h=t=>s.hasOwnProperty(t)?s[t]:null,c=t=>{t=!0===t,OS.Std.out((t?"\n":"")+CMD.Colourize(e+"@"+n,CMD.Colours.green)+CMD.Colourize(":",CMD.Colours.white)+CMD.Colourize(r.replace("/home/"+e,"~"),CMD.Colours.blue)+CMD.Colourize("$ ",CMD.Colours.white))},l=t=>{const e=t.split("§§§").filter(t=>t.length>0);switch(e[0].toLowerCase()){case"ctrl":(t=>{switch(console.log("CTRL CODE",t),t){case"c":OS.Std.out("^C"),c(!0)}})(e[1]);break;case"dir":(t=>{(u=t)<0&&(u=0),u>a.length&&(u=a.length),OS.Std.prompt(a[a.length-u])})(parseInt(e[1],10)+u);break;default:console.log("SPECIAL CODE",e)}};OS.Process.endEvent(t=>{null!==h(t)&&(delete s[t],t===i&&(i=-1,c(o)))}),OS.Std.inEvent(e=>{if(console.log("STD:IN",(()=>t.exec+"["+t.id+"]")(),e),"user"===e.from){if("string"==typeof e.data)if(e.data.startsWith("§§§"))l(e.data);else{if(i>0)return console.log("PASS ON STD IN",t.id),void OS.Std.in(i,e.data,e.from);if("exit"===e.data)return void OS.Process.end();const r=e.data.split(" ").map(t=>t.trim()),n=r.shift()||"";OS.Process.start(n,r).then(t=>{o=!1,s[t.id]=t,i=t.id}).catch(t=>{console.log("EXEC ERROR",t);try{"FS Error"===t[1]&&"Not found"===t[3]?OS.Std.out(n+": command not found"):OS.Std.out(t[1])}catch(t){OS.Std.out(["BASH LAUNCH ERROR",t.message])}c(!0)}),(t=>{t.length>0&&t!==a[a.length-1]&&(a.push(t),OS.FS.append("~/.bash_history",t+"\n")),u=0})(e.data)}}else(t=>{const e=h(t.from);let r=t.data;return t.data instanceof Array&&"ERROR"===t.data[0]&&(r=e.exec.split("/").pop()+": "+t.data[2]),parseInt(t.from,10)===i&&(o=!0),OS.Std.out(r),Promise.resolve()})(e).then(()=>{})}),(n=>{t=n,e=n.identity.user,r=n.identity.workingDir,OS.FS.read("~/.bash_history").then(t=>{a=t.split("\n").filter(t=>t.length>0).filter((t,e,r)=>e>0&&r[e-1]!==t)}),c()})(PROCESS)},mkdir:()=>{const t=[["Usage: mkdir[OPTION]...DIRECTORY..."],["Create the DIRECTORY(ies), if they do not already exist."],[""],["Mandatory arguments to long options are mandatory for short options too."],["  - p, --parents","no error if existing, make parent directories as needed"],["  - v, --verbose","print a message for each created directory"],["  ","--help","","display this help and exit"],["  ","--version","output version information and exit"]],e=["mkdir (GNU coreutils) 0.1","Copyright(C) 2010 wlf.io.","License MIT License < https://raw.githubusercontent.com/wlfio/TSPseudoOS/master/LICENSE >.","This is free software: you are free to change and redistribute it.","There is NO WARRANTY, to the extent permitted by law.","","Written by wlf.io."].join("\n"),r={help:!1,version:!1,verbose:!1,parents:!1},n={"?":"help",v:"verbose",p:"parents"};const i=async t=>{let e="";try{const n=await OS.FS.resolve(t);console.log("PATHS",n);const i=(t=>t.map(t=>r.parents?(t=>{return t.split("/").filter(t=>t.length>0).reduce((t,e,r)=>(e=0===r?"/"+e:t[t.length-1]+"/"+e,t.push(e),t),[])})(t):[t]))(n);console.log("BROKEN",i);for(let t=0;t<i.length;t++){const n=i[t];for(let t=0;t<n.length;t++){const i=n[t],o=await OS.FS.mkdir(i);console.log("PATH DONE",i,o),r.verbose&&o&&OS.Std.out(e+"created directory '"+n[0]+"'"),o||r.parents||OS.Std.out(e+"cannot create directory '"+n[0]+"': File exists"),e="\n"}}OS.Process.end()}catch(t){console.log("ERROROR",t),(t=>{t instanceof Array&&"Path is not directory"===t[2]&&(t=new Error("MKDIR ERROR : no such file or directory '"+t[3]+"' : "+t.join(" : "))),OS.Process.crash(t)})(t)}};(async o=>{const s=await OS.Util.loadArgs(o,r,n);s.length<1&&!r.help&&!r.version?OS.Process.crash(new Error(["mkdir error","missing operand\nTry 'mkdir --help' for more information",JSON.stringify(o)].join(" : "))):r.help?OS.Std.out(t):r.version?OS.Std.out(e):i(s)})(PROCESS.params)},cat:()=>{const t={number:!1,"squeeze-blank":!1},e={n:"number",s:"squeeze-blank"};let r=0;const n=t=>{OS.Process.crash(t)},i=e=>{OS.Std.out((e=>{const n=[];let i=!1;return e.split("\n").forEach(e=>{if(r++,e.length<1){if(i)return;i=!0}else i=!1;const o=[];t.number&&o.push(r.toString()),o.push(e),n.push(o)}),n})(e))};(r=>{OS.Util.loadArgs(r,t,e).then(t=>{if(t.length<1)throw new Error("CAT ERROR : you must include file path(s) : "+JSON.stringify(r));(async t=>{try{for(let e=0;e<t.length;e++){const r=await OS.FS.read(t[e]);i(r)}OS.Process.end()}catch(t){n(t)}})(t)}).catch(t=>{console.log("CAT ERROR",t),n(t)})})(PROCESS.params)}},V=new k("root",[],"/"),X=new k("guest",[],"/home/guest"),Q=(()=>{try{return window.self!==window.top}catch(t){return!0}})();L.mkdir("/bin",V),L.mkdir("/home",V),L.mkdir("/home/guest",V).then(()=>{L.chown("/home/guest",V,"guest","guest").then(()=>{L.mkdir("/home/guest/bin",X),L.write("/home/guest/test","Lorem ipsum dolor sit amet, consectetur \n\n\n\n\n\n\n adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",X),L.mkdir("/home/guest/bin",X)})}),L.mkdir("/home/root",V),Object.entries(G).map(t=>{L.write("bin/"+t[0],t[1].toString(),V),L.chmod("bin/"+t[0],V,"755")});const Z=new class{constructor(){this.queuedItems=[],this.processManager=null,this.display=document.createElement("div"),this.input=document.createElement("span")}init(t){this.processManager=t,this.createDisplay(),document.addEventListener("keydown",()=>{document.activeElement!==this.input&&this.input.focus()}),this.input.addEventListener("keydown",t=>{if(t.ctrlKey&&"Control"!==t.key&&!t.repeat)this.controlKey(t.key);else if("ArrowUp"!==t.key&&"ArrowDown"!==t.key||t.repeat){if("Enter"!==t.key)return;t.repeat||this.enterText()}else this.history("ArrowDown"===t.key?-1:1);t.preventDefault()}),this.processQueue()}colourizeText(t){return t.split(/(?=§[0-9A-F]{6})/).map(t=>{const e=document.createElement("span");if(t.startsWith("§")){const r=t.slice(0,7);e.setAttribute("style","color:#"+r.slice(1,4)+";background-color:#"+r.slice(4,7)+";"),t=t.slice(7)}return e.textContent=t,e})}breakUptext(t){const e=[];return t.split("\n").forEach((t,r,n)=>{const i=document.createElement("span");this.colourizeText(t).forEach(t=>{i.append(t)}),e.push(i),r<n.length-1&&e.push(document.createElement("br"))}),e}writeToDisplay(t,e){e=e||0,t.map(t=>{this.display.insertBefore(t,this.input)})}reduceArrayForDisplay(t,e){return t.reduce((t,r,n)=>{const i=typeof r;return"string"===i||"number"===i?t+=(n<1?"":"\t")+r:r instanceof Array&&(t+=(n<1?"":"\n")+this.reduceArrayForDisplay(r,e+1)),t},"")}processDisplayData(t){return t instanceof Array?this.reduceArrayForDisplay(t,0):(console.log(t),"FAILED TO CONVERT FOR DISPLAY")}output(t,e,r){r=!0===r;let n="";n="string"!=typeof t?this.processDisplayData(t):t;const i=this.breakUptext(n);r&&i.push(document.createElement("br")),this.writeToDisplay(i,e)}prompt(t){console.log("PROMPT",t)}processQueue(){this.queuedItems.map(t=>{this.writeToDisplay(t.text,t.over)})}createDisplay(){this.display.id="output",this.display.tabIndex=-1,this.input.id="input",this.input.tabIndex=0,this.input.contentEditable="true",this.input.spellcheck=!1;const t=document.querySelector("body");null!==t&&(t.append(this.display),this.display.append(this.input))}history(t){this.specialUserInput("DIR",t.toString())}controlKey(t){this.specialUserInput("CTRL",t)}setText(t){this.input.textContent=t}enterText(){const t=this.input.textContent||"";t.length>0&&(this.output(t,0,!0),this.userInput(t),this.setText(""))}specialUserInput(t,e){this.userInput("§§§"+t+"§§§"+e)}userInput(t){null!==this.processManager&&this.processManager.stdIn("user",t)}},$=new class{constructor(){this.display=null,this.processes={},this.pids=0,this.pending=[],this.libJS=null,this.mainProcess=null,this.OS={FS:{list:(t,e)=>L.list(e,t),mkdir:(t,e)=>L.mkdir(e,t),resolve:(t,e)=>L.resolveWorkingPaths(e,t),append:(t,e)=>L.append(e.path,e.content,t),write:(t,e)=>L.write(e.path,e.content,t),touch:(t,e)=>L.touch(e,t),read:(t,e)=>L.read(e,t)},Process:{end:t=>t.kill(),setSelf:(t,e)=>t.set(e.prop,e.value),self:t=>Promise.resolve(t.data()),start:(t,e)=>this.startProcess(e.exec,e.params,null,t),crash:(t,e)=>{this.OS.Std.out(t,e),t.kill()}},Std:{out:(t,e)=>t.hasParent()?t.intoParent(e):this.OS.Out.print({data:e,over:0}),prompt:(t,e)=>{null!==this.mainProcess&&this.mainProcess.id===t.id&&null!==this.display&&this.display.setText(e)},in:(t,e)=>t.intoChild(e.pid,e.data,e.source||null)},Out:{print:t=>this.output(t.data,t.over,!1),printLn:t=>(console.log(t),this.output(t.data,t.over,!0))}},this.startProcess=(t,e,r,n)=>{if(null===this.libJS)return this.pendStart(t,e,r,n);r=r||n.identity;try{return new Promise((i,o)=>{L.execRead(t,r).then(t=>{const s=t[0],a=t[1];this.pids++;const u=new H(this.pids,s,e,r,n);u.loadLibJS(this.libJS||""),u.loadBin("("+a+")();"),this.processes[this.pids]=u,null===this.mainProcess&&(this.mainProcess=u),this.createContainer(u.id,u).then(t=>{u.spawn(t),i(u.data())}).catch(t=>{o(t)})}).catch(r=>{console.log("START APP FAILED",t,e,n),o(r)})})}catch(t){return console.log(["Process Error",t]),Promise.reject(["Process Error",t])}},this.processContainer=document.createElement("div"),this.pendingContainer=this.createRawContainer()}output(t,e,r){null!==this.display&&this.display.output(t,e,r)}init(t){this.processContainer.id="processes";const e=document.querySelector("body");null!==e&&e.append(this.processContainer),this.display=t,K().then(t=>{this.libJS=t.replace(/sourceMappingURL/g,""),this.startPending()}).catch(t=>console.log("FETCH LIB ERROR",t))}killProcess(t){const e=this.getProcessFromID(t);null!==e&&e.kill()}stdIn(t,e){null!==this.mainProcess?this.mainProcess.stdIn(t,e):console.log("STDIN",e)}getProcessFromSource(t){return Object.values(this.processes).find(e=>e.isSource(t))||null}getProcessFromID(t){return Object.values(this.processes).find(e=>e.id===t)||null}startPending(){try{this.pending.forEach(t=>{this.startProcess(t.args[0],t.args[1],t.args[2],t.args[3]).then(t.resolve).catch(t.reject)})}catch(t){console.log("START PEND ERROR",t)}}pendStart(t,e,r,n){return new Promise((i,o)=>{this.pending.push({args:[t,e,r,n],resolve:i,reject:o})})}createRawContainer(){const t=document.createElement("iframe");return t.sandbox.add("allow-scripts"),t.sandbox.add("allow-same-origin"),t.id="pending-container",this.processContainer.append(t),t}getRawContainer(){null===this.pendingContainer&&(this.pendingContainer=this.createRawContainer());const t=this.pendingContainer;return this.pendingContainer=null,window.setTimeout(()=>{null===this.pendingContainer&&(this.pendingContainer=this.createRawContainer())},100),t}createContainer(t,e){const r=this.getRawContainer();return r.setAttribute("data-exec",e.exec),r.setAttribute("data-user",e.identity.user),r.id="pid-"+t,Promise.resolve(r)}appMessage(t){const e=this.getProcessFromSource(t.source);if(null===e)return;const r=t.data,n=r.type;if("boot"===n.service)return void e.respond(e.params,r.id);const i=this.systemCall(e,n,r.data);if("string"==typeof r.id&&r.id.length>0){if(!(i instanceof Promise))throw["Syscall Error",n.service+">"+n.func,"did not return promise"];i.then(t=>{e.respond(t,r.id)}).catch(t=>e.respond(null,r.id,t))}}systemCall(t,e,r){return this.OS.hasOwnProperty(e.service)&&this.OS[e.service].hasOwnProperty(e.func)?this.OS[e.service][e.func](t,r):Promise.reject(new Error(["PM Error","Atempt to access non-existant System Call\n"+e.service+">"+e.func,t.exec+"["+t.id+"]"].join(" : ")))}};document.addEventListener("DOMContentLoaded",()=>{console.log(location.host,Q),Z.init($),$.init(Z),Z.output([["Welcome to wlf.io TSPseudoOS v0.1 LTNS(Little To No Support)"],[""],["  * Try the command help to see what you can do"],[""],["Last Login: Fri, 25 Oct 2019 18: 57: 47 GMT"]],0,!0),window.addEventListener("message",t=>{$.appMessage(t)}),$.startProcess("bash",[],X)})}]);
//# sourceMappingURL=os.bundle.js.map